---
title: "Análise Exploratória de Dados da Educação Superior em R"
output: html_notebook
---

---

# 1. Introdução

Neste notebook do R iremos analisar microdados educacionais extraidos do [Senso Educacional 2024](https://www.gov.br/inep/pt-br/acesso-a-informacao/dados-abertos/microdados/censo-da-educacao-superior)


# 2. Lendo os dados
Os comandos abaixo fará a leitura dos seguintes dados:

- Dicionário de dados onde contem ...
- Cadastro de cursos superiores
- Cadastro das instituições de educação, abrangendo Universidades e Institutos Federais

```{r message=FALSE, warning=FALSE}
library(readxl)
library(readr)
library(dplyr)
library(tidyr)
library(ggplot2)
library(scales)
```


# Dicionário de dados
```{r}
disc_dados <- read_excel("~/FCM - Projeto Final/Projeto_Ferramentas_Computacionais/microdados_censo_da_educacao_superior_2024/microdados_censo_da_educacao_superior_2024/Anexos/ANEXO I - Dicionário de Dados/dicionário_dados_educação_superior.xlsx")
```

# Cursos
```{r}
cadastro_cursos <- read.csv(
  "~/FCM - Projeto Final/Projeto_Ferramentas_Computacionais/microdados_censo_da_educacao_superior_2024/microdados_censo_da_educacao_superior_2024/dados/MICRODADOS_CADASTRO_CURSOS_2024.CSV",
  sep = ";",
  encoding = "latin1"
)
```


# Cadastro de Instituições
```{r}
microdados_ies <- read.csv(
  "~/FCM - Projeto Final/Projeto_Ferramentas_Computacionais/microdados_censo_da_educacao_superior_2024/microdados_censo_da_educacao_superior_2024/dados/MICRODADOS_ED_SUP_IES_2024.CSV",
  sep = ";",
  encoding = "latin1",
  header = TRUE
)
```

# População por UF
```{r}
POP_UF <- read_excel("~/FCM - Projeto Final/Projeto_Ferramentas_Computacionais/dados_populacionais/POP_UF.xls")
```

# 3.7 Perfil dos Alunos

# 3.7.1 Matrículas vs Concluintes 

O gráfico da Figura 13 abaixo tem como objetivo comparar o número de alunos matriculados com o número de concluintes.

```{r}
matriculas_concluintes <- cadastro_cursos %>%
  summarise(
    Matrículas  = sum(QT_MAT, na.rm = TRUE),
    Concluintes = sum(QT_CONC, na.rm = TRUE)
  ) %>%
  pivot_longer(cols = everything(),
               names_to = "Categoria",
               values_to = "Quantidade")

ggplot(matriculas_concluintes, aes(x = Categoria, y = Quantidade, fill = Categoria)) +
  geom_col(alpha = 0.8, width = 0.7) +
  geom_text(aes(label = scales::comma(Quantidade)),
            vjust = -0.3, size = 4, fontface = "bold") +
  labs(
    title = "Figura 13: Comparativo entre Matrículas e Concluintes",
    x = "Categoria",
    y = "Quantidade de Alunos"
  ) +
  scale_y_continuous(
    labels = scales::comma,
    expand = expansion(mult = c(0, 0.15))
  ) +
  theme_classic() +
  theme(
    axis.text.x = element_text(angle = 0, hjust = 0.5, size = 12),
    axis.text.y = element_text(size = 12),
    plot.title = element_text(size = 16, face = "bold", hjust = 0.3, margin = margin(b = 20)),
    axis.title.x = element_text(face = "bold", size = 14, margin = margin(r = 10)),
    axis.title.y = element_text(face = "bold", size = 14, margin = margin(r = 10)),
    legend.position = "none"
  )
```
Em relação a quantidade de alunos que realizaram a matrícula em algum curso do Ensino Superior e aqueles que concluíram, podemos observar uma grande disparidade. Enquanto cerca de 10 milhões de estudantes ingressam, menos de 1,5 milhões concluem seus cursos. Isso sugere uma taxa significativa de evasão ou retenção no sistema educacional. A diferença aponta para desafios estruturais que impactam a permanência e o sucesso acadêmico dos alunos.

Já a Figura 14 apresenta a distribuição de matrículas e concluintes segundo a rede de ensino (pública e privada).

```{r}
cursos_rede <- cadastro_cursos %>%
  left_join(microdados_ies %>% select(CO_IES, TP_REDE), by = "CO_IES") %>%
  mutate(REDE = ifelse(TP_REDE.y == 1, "Pública", "Privada"))
```

```{r}
alunos_rede <- cursos_rede %>%
  group_by(REDE) %>%
  summarise(
    Matrículas  = sum(QT_MAT, na.rm = TRUE),
    Concluintes = sum(QT_CONC, na.rm = TRUE)
  ) %>%
  pivot_longer(cols = c(Matrículas, Concluintes),
               names_to = "Categoria",
               values_to = "Quantidade")

# Gráfico padronizado sem porcentagem
ggplot(alunos_rede, aes(x = REDE, y = Quantidade, fill = Categoria)) +
  geom_col(alpha = 0.8, width = 0.7, position = position_dodge(width = 0.8)) +
  geom_text(aes(label = scales::comma(Quantidade)),
            position = position_dodge(width = 0.8),
            vjust = -0.3, size = 4, fontface = "bold") +
  labs(
    title = "Figura 14: Matrículas e Concluintes por Rede",
    x = "Rede",
    y = "Quantidade de Alunos"
  ) +
  scale_y_continuous(
    labels = scales::comma,
    expand = expansion(mult = c(0, 0.15))
  ) +
  theme_classic() +
  theme(
    axis.text.x = element_text(angle = 0, hjust = 0.5, size = 12),
    axis.text.y = element_text(size = 12),
    plot.title = element_text(size = 16, face = "bold", hjust = 0.3, margin = margin(b = 20)),
    axis.title.x = element_text(face = "bold", size = 14, margin = margin(r = 10)),
    axis.title.y = element_text(face = "bold", size = 14, margin = margin(r = 10)),
    legend.title = element_blank(),
    legend.position = "bottom"
  )
```

O gráfico evidencia a disparidade entre matrículas e concluintes nas redes privada e pública de ensino superior. A rede privada concentra a maior parte dos alunos, com mais de 8 milhões de matrículas e cerca de 1 milhão de concluintes, enquanto a rede pública apresenta pouco mais de 2 milhões de matrículas e 256 mil concluintes. Esses dados indicam que, embora a rede privada absorva a maior demanda, a taxa de conclusão permanece proporcionalmente baixa em ambas as redes, sugerindo desafios comuns na permanência e conclusão dos cursos.

# 3.7.2 Faixa Etária
Realizamos a análise a seguir, na Figura 15, com o intuito de mostrar a distribuição dos alunos por faixa etária. 

```{r}
faixa_etaria <- cadastro_cursos %>%
  summarise(
    `0-17`   = sum(QT_ING_0_17, na.rm = TRUE),
    `18-24`  = sum(QT_ING_18_24, na.rm = TRUE),
    `25-29`  = sum(QT_ING_25_29, na.rm = TRUE),
    `30-34`  = sum(QT_ING_30_34, na.rm = TRUE),
    `35-39`  = sum(QT_ING_35_39, na.rm = TRUE),
    `40-49`  = sum(QT_ING_40_49, na.rm = TRUE),
    `50-59`  = sum(QT_ING_50_59, na.rm = TRUE),
    `60+`    = sum(QT_ING_60_MAIS, na.rm = TRUE)
  ) %>%
  pivot_longer(cols = everything(),
               names_to = "Faixa_Etaria",
               values_to = "Quantidade") %>%
  mutate(percentual = round(Quantidade / sum(Quantidade) * 100, 1))

# Gráfico com estilo igual ao de etnia, mas mantendo cores distintas por faixa
ggplot(faixa_etaria, aes(x = Faixa_Etaria, y = Quantidade, fill = Faixa_Etaria)) +
  geom_col(alpha = 0.8, width = 0.7) +
  geom_text(aes(label = paste0(scales::comma(Quantidade), "\n(", percentual, "%)")),
            vjust = -0.3, size = 4, fontface = "bold", lineheight = 0.8) +
  labs(
    title = "Figura 15: Distribuição de Alunos por Faixa Etária",
    x = "Faixa Etária",
    y = "Quantidade de Alunos"
  ) +
  scale_y_continuous(
    labels = scales::comma,
    expand = expansion(mult = c(0, 0.15))
  ) +
  theme_classic() +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1, size = 12),
    axis.text.y = element_text(size = 12),
    plot.title = element_text(size = 16, face = "bold", hjust = 0.3, margin = margin(b = 20)),
    axis.title.x = element_text(face = "bold", size = 14, margin = margin(r = 10)),
    axis.title.y = element_text(face = "bold", size = 14, margin = margin(r = 10)),
    legend.position = "none" 
  )
```

A maioria dos alunos que iniciam a graduação estão na faixa etária de 18 a 24 anos, ultrapassando 2 milhões. As faixas de 25 a 39 anos também apresentam números expressivos, indicando presença significativa de adultos jovens no sistema educacional. Já os extremos de 0-17 e acima de 50 anos, têm participação muito menor. Isso revela que o ensino superior é majoritariamente frequentado por jovens adultos.

A Figura 16 apresenta a taxa de conclusão dos cursos de graduação segundo a faixa etária dos alunos.

```{r}
# Criar tabela de taxa de conclusão por faixa etária
taxa_conclusao_etaria <- cadastro_cursos %>%
  summarise(
    `0-17`    = sum(QT_CONC_0_17, na.rm = TRUE)    / sum(QT_MAT_0_17, na.rm = TRUE)    * 100,
    `18-24`   = sum(QT_CONC_18_24, na.rm = TRUE)   / sum(QT_MAT_18_24, na.rm = TRUE)   * 100,
    `25-29`   = sum(QT_CONC_25_29, na.rm = TRUE)   / sum(QT_MAT_25_29, na.rm = TRUE)   * 100,
    `30-34`   = sum(QT_CONC_30_34, na.rm = TRUE)   / sum(QT_MAT_30_34, na.rm = TRUE)   * 100,
    `35-39`   = sum(QT_CONC_35_39, na.rm = TRUE)   / sum(QT_MAT_35_39, na.rm = TRUE)   * 100,
    `40-49`   = sum(QT_CONC_40_49, na.rm = TRUE)   / sum(QT_MAT_40_49, na.rm = TRUE)   * 100,
    `50-59`   = sum(QT_CONC_50_59, na.rm = TRUE)   / sum(QT_MAT_50_59, na.rm = TRUE)   * 100,
    `60+`     = sum(QT_CONC_60_MAIS, na.rm = TRUE) / sum(QT_MAT_60_MAIS, na.rm = TRUE) * 100
  ) %>%
  pivot_longer(cols = everything(),
               names_to = "Faixa_Etaria",
               values_to = "Taxa_Conclusao")
```

```{r}
# Gráfico da taxa de conclusão por faixa etária
ggplot(taxa_conclusao_etaria, aes(x = Faixa_Etaria, y = Taxa_Conclusao, fill = Faixa_Etaria)) +
  geom_col(alpha = 0.8, width = 0.7) +
  geom_text(aes(label = paste0(round(Taxa_Conclusao, 1), "%")),
            vjust = -0.3, size = 4, fontface = "bold") +
  labs(
    title = "Figura 16: Taxa de Conclusão por Faixa Etária",
    x = "Faixa Etária",
    y = "Taxa de Conclusão (%)"
  ) +
  scale_y_continuous(
    labels = scales::percent_format(scale = 1),
    expand = expansion(mult = c(0, 0.15))
  ) +
  theme_classic() +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1, size = 12),
    axis.text.y = element_text(size = 12),
    plot.title = element_text(size = 16, face = "bold", hjust = 0.3, margin = margin(b = 20)),
    axis.title.x = element_text(face = "bold", size = 14, margin = margin(r = 10)),
    axis.title.y = element_text(face = "bold", size = 14, margin = margin(r = 10)),
    legend.position = "none"
  )
```
O gráfico revela que a taxa de conclusão é mais elevada entre alunos de 25 a 29 anos (17,8%), enquanto o grupo de 18 a 24 anos apresenta a menor taxa (9,5%). Essa diferença pode ser explicada, em parte, pelo tempo necessário para concluir a graduação, muitos alunos que ingressam aos 18 anos ainda estão cursando quando têm entre 18 e 24 anos, não sendo contabilizados como concluintes no período analisado.

# 3.7.3 Etnia
A seguir, na Figura 17, a composição étnica dos alunos.

```{r}
etnia <- cadastro_cursos %>%
  summarise(
    Branca = sum(QT_ING_BRANCA, na.rm = TRUE),
    Preta = sum(QT_ING_PRETA, na.rm = TRUE),
    Parda = sum(QT_ING_PARDA, na.rm = TRUE),
    Amarela = sum(QT_ING_AMARELA, na.rm = TRUE),
    Indígena = sum(QT_ING_INDIGENA, na.rm = TRUE),
    Sem_Informação = sum(QT_ING_CORND, na.rm = TRUE)
  ) %>%
  pivot_longer(cols = everything(),
               names_to = "Etnia",
               values_to = "Quantidade") %>%
  mutate(percentual = round(Quantidade / sum(Quantidade) * 100, 1))

# Gráfico formatado
ggplot(etnia, aes(x = Etnia, y = Quantidade, fill = Etnia)) +
  geom_col(alpha = 0.8, width = 0.7) +
  geom_text(aes(label = paste0(scales::comma(Quantidade), "\n(", percentual, "%)")),
            vjust = -0.3, size = 4, fontface = "bold", lineheight = 0.8) +
  labs(
    title = "Figura 17: Distribuição de Alunos por Etnia",
    x = "Etnia",
    y = "Quantidade de Alunos"
  ) +
  scale_y_continuous(
    labels = scales::comma,
    expand = expansion(mult = c(0, 0.15))
  ) +
  theme_classic() +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1, size = 12),
    axis.text.y = element_text(size = 12),
    plot.title = element_text(size = 16, face = "bold", hjust = 0.3, margin = margin(b = 20)),
    axis.title.x = element_text(face = "bold", size = 14, margin = margin(r = 10)),
    axis.title.y = element_text(face = "bold", size = 14, margin = margin(r = 10)),
    legend.position = "none" 
  )
```
O gráfico revela que a maioria dos alunos se autodeclara branca, com mais de 2 milhões registrados. As categorias parda e sem informação também apresentam números expressivos, em torno de 1 milhão cada. Já as etnias preta, amarela e indígena têm participação significativamente menor. Essa distribuição aponta para desigualdades étnicas no acesso à educação, além de possíveis lacunas na coleta de dados devido a quantidade de alunos "sem informação" sobre sua etnia.

# 3.7.4 Genêro
A Figura 18 apresenta a distribuição de matrículas e concluintes no ensino superior segundo o gênero dos alunos.

```{r}
alunos_genero <- cadastro_cursos %>%
  summarise(
    Matrículas_Feminino  = sum(QT_MAT_FEM, na.rm = TRUE),
    Matrículas_Masculino = sum(QT_MAT_MASC, na.rm = TRUE),
    Concluintes_Feminino  = sum(QT_CONC_FEM, na.rm = TRUE),
    Concluintes_Masculino = sum(QT_CONC_MASC, na.rm = TRUE)
  ) %>%
  pivot_longer(cols = everything(),
               names_to = "Categoria",
               values_to = "Quantidade") %>%
  mutate(
    Grupo = ifelse(grepl("Feminino", Categoria), "Feminino", "Masculino"),
    Tipo  = ifelse(grepl("Matrículas", Categoria), "Matrículas", "Concluintes")
  )

ggplot(alunos_genero, aes(x = Grupo, y = Quantidade, fill = Tipo)) +
  geom_col(alpha = 0.8, width = 0.7, position = position_dodge(width = 0.8)) +
  geom_text(aes(label = scales::comma(Quantidade)),
            position = position_dodge(width = 0.8),
            vjust = -0.3, size = 4, fontface = "bold") +
  labs(
    title = "Figura 18: Matrículas e Concluintes por Gênero",
    x = "Gênero",
    y = "Quantidade de Alunos"
  ) +
  scale_y_continuous(
    labels = scales::comma,
    expand = expansion(mult = c(0, 0.15))
  ) +
  theme_classic() +
  theme(
    axis.text.x = element_text(angle = 0, hjust = 0.5, size = 12),
    axis.text.y = element_text(size = 12),
    plot.title = element_text(size = 16, face = "bold", hjust = 0.3, margin = margin(b = 20)),
    axis.title.x = element_text(face = "bold", size = 14, margin = margin(r = 10)),
    axis.title.y = element_text(face = "bold", size = 14, margin = margin(r = 10)),
    legend.title = element_blank(),
    legend.position = "bottom"
  )
```
O gráfico evidencia que as mulheres representam a maioria tanto entre os matriculados quanto entre os concluintes, com mais de 6 milhões de matrículas e cerca de 793 mil concluintes, em comparação a 4,1 milhões de matrículas e 540 mil concluintes entre os homens. Esses dados reforçam a crescente presença feminina no ensino superior brasileiro, mas também indicam que os desafios de permanência e conclusão afetam ambos os grupos de forma comparável.

# 3.7.5 Financiamento
A Figura 19 apresenta a distribuição de alunos matriculados no ensino superior segundo o tipo de financiamento utilizado


```{r}

alunos_financiamento <- cadastro_cursos %>%
  summarise(
    FIES        = sum(QT_MAT_FIES, na.rm = TRUE),
    ProUni_Pub  = sum(QT_MAT_PROUNII, na.rm = TRUE),
    ProUni_Priv = sum(QT_MAT_PROUNIP, na.rm = TRUE),
    Outros_Reemb = sum(QT_MAT_FINANC_REEMB, na.rm = TRUE),
    Outros_NReemb = sum(QT_MAT_FINANC_NREEMB, na.rm = TRUE)
  ) %>%
  pivot_longer(cols = everything(),
               names_to = "TipoFinanciamento",
               values_to = "Quantidade") %>%
  mutate(percentual = round(Quantidade / sum(Quantidade) * 100, 1)) %>%
  arrange(desc(Quantidade)) %>%
  mutate(TipoFinanciamento = recode(TipoFinanciamento,
    "FIES" = "FIES",
    "ProUni_Pub" = "ProUni Público",
    "ProUni_Priv" = "ProUni Privado",
    "Outros_Reemb" = "Outros Reembolsáveis",
    "Outros_NReemb" = "Outros Não Reembolsáveis"
  ))

  ggplot(alunos_financiamento, aes(x = TipoFinanciamento, y = Quantidade, fill = TipoFinanciamento)) +
  geom_col(width = 0.7, alpha = 0.8) +
  geom_text(aes(label = paste0(scales::comma(Quantidade), " (", percentual, "%)")),
            vjust = -0.5, size = 4, fontface = "bold") +
  labs(
    title = "Figura 19",
    subtitle = "Figura 19: Matrículas por Tipo de Financiamento",
    x = "Tipo de Financiamento",
    y = "Quantidade de Alunos"
  ) +
  scale_y_continuous(labels = scales::comma,
                     expand = expansion(mult = c(0, 0.15))) +
  theme_classic() +
  theme(
    plot.title = element_text(size = 16, face = "bold", hjust = 0.5),
    plot.subtitle = element_text(size = 14, hjust = 0.5),
    axis.text.x = element_text(size = 12, angle = 20, hjust = 1),
    legend.position = "none"
  )
```
O gráfico revela que a maioria dos alunos (77,3%) está vinculada ao grupo “Outros Não Reembolsáveis”, que engloba bolsas institucionais, filantrópicas ou de incentivo que não exigem devolução dos recursos. Esse dado indica que o acesso ao ensino superior depende fortemente de mecanismos de apoio direto, fora dos programas federais tradicionais. O ProUni, voltado à concessão de bolsas integrais ou parciais, representa 11,7% das matrículas, com maior presença na rede pública (10,2%) do que na privada (1,5%). Já o FIES, programa de crédito estudantil reembolsável, atende apenas 4,2% dos alunos. Os “Outros Reembolsáveis”, que incluem financiamentos privados ou institucionais com exigência de pagamento futuro, representam 6,9%. A predominância de bolsas não reembolsáveis sugere que, para grande parte dos estudantes, a permanência no ensino superior está condicionada à oferta de apoio financeiro direto e sem contrapartida.

# 3.7.6 Distribuição dos alunos por UF
A Figura 20 apresenta a distribuição geográfica das matrículas no ensino superior brasileiro, por unidade federativa.


```{r}
library(sf)       
library(geobr)

ggplot(mapa_alunos) +
  geom_sf(aes(fill = Faixa), color = "white", size = 0.2) +
  scale_fill_brewer(palette = "Blues") +
  labs(
    title = "Figura 20: Distribuição Geográfica das Matrículas por Estado",
    fill  = "Faixa de Matrículas"
  ) +
  scale_x_continuous(labels = function(x) paste0(abs(x), "° O")) +
  scale_y_continuous(labels = function(y) paste0(abs(y), "° S")) +
  theme_classic() +
  theme(
    plot.title   = element_text(size = 16, face = "bold", hjust = 0.3, margin = margin(b = 20)),
    legend.title = element_text(face = "bold", size = 14),
    legend.text  = element_text(size = 12)
  )
```

O mapa revela forte concentração de matrículas nos estados do Sudeste, com destaque para São Paulo, que lidera em número absoluto de alunos. Minas Gerais e Rio de Janeiro também apresentam volumes elevados, enquanto estados das regiões Norte e Centro-Oeste registram os menores índices. Essa distribuição reflete desigualdades históricas na oferta de educação superior, associadas à densidade populacional, à infraestrutura educacional e à presença de instituições privadas. A concentração regional das matrículas reforça a necessidade de políticas públicas que ampliem o acesso em áreas menos atendidas, promovendo maior equidade territorial na educação superior.


