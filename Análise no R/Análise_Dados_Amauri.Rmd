#Carregando as bibliotecas library(readxl) library(readr) library(dplyr) library(tidyr) library(ggplot2)

#Localização dos dados dicionario_dados \<- read_excel("/microdados_censo_da_educacao_superior_2024/dicionario_dados_educacao_superior.xlsx") dados_cursos \<- read.csv("/microdados_censo_da_educacao_superior_2024/MICRODADOS_CADASTRO_CURSOS_2024.CSV", sep=';', encoding='latin1')

#Montagem do banco de dados analise 3.3 dadosA \<- data.frame( "Curso" = dados_cursos$NO_CINE_ROTULO,
  "Tipo_de_curso"= case_when(
      dados_cursos$TP_GRAU_ACADEMICO == 1 \~ "Bacharelado", dados_cursos$TP_GRAU_ACADEMICO == 2 ~ "Licenciatura",
      dados_cursos$TP_GRAU_ACADEMICO == 3 \~ "Tecnólogo", dados_cursos$TP_GRAU_ACADEMICO == 4 ~ "Bacharelado e Licenciatura",
      TRUE ~ "Não se aplica"
    ),
  "Quantidade_de_vagas"= dados_cursos$QT_VG_TOTAL, "Numero_de_ingressantes"=dados_cursos$QT_ING,
  "Numero_de_concluintes"=dados_cursos$QT_CONC )

#Contando quantos tem de cada curso dadosA_frequentes \<- dadosA %\>% group_by(Curso) %\>% summarise( Quantidade_de_dadosA = n(),.groups = 'drop') %\>% mutate(Total_Geral = sum(Quantidade_de_dadosA),`Percentual (%)` = round((Quantidade_de_dadosA / Total_Geral) \* 100, 2) ) %\>% select(-Total_Geral)

ord_dadosA \<- dadosA_frequentes %\>% arrange(desc(Quantidade_de_dadosA))%\>% slice_head(n = 10) print(ord_dadosA)

#Verificando o tipo de curso tipo_curso \<- dadosA %\>% group_by(Tipo_de_curso) %\>% summarise( Quant_grau =n(),.groups = 'drop') %\>% mutate(Total_tipo = sum(Quant_grau),`Percentual (%)` = round((Quant_grau / Total_tipo) \*100, 2) ) %\>% select(-Total_tipo,-Quant_grau)

ord_tipo \<- tipo_curso %\>% arrange(desc(`Percentual (%)`)) print(ord_tipo)

#Vaga e ingressantes por tipo de curso vagasA\<- dadosA %\>% group_by(Tipo_de_curso) %\>% summarise( vagas_total = sum(Quantidade_de_vagas), ingressantes= sum(Numero_de_ingressantes), `%_vagas_preenchidas`= round((ingressantes/vagas_total) *100,2), concluintes= sum(Numero_de_concluintes), `%_de_concluintes`= round((concluintes/ingressantes)* 100,2), .groups = 'drop') print(vagasA)

#Montagem banco de dados analise 3.4 dadosB \<-data.frame( "regiao"= case_when( dados_cursos$NO_REGIAO==""~"Remoto",
    dados_cursos$NO_REGIAO=="Centro-Oeste"\~"Centro-Oeste", dados_cursos$NO_REGIAO=="Nordeste"~"Nordeste",
    dados_cursos$NO_REGIAO=="Norte"\~"Norte", dados_cursos$NO_REGIAO=="Sudeste"~"Sudeste",
    dados_cursos$NO_REGIAO=="Sul"\~"Sul"), "qnt_vagas"= dados_cursos$QT_VG_TOTAL,
  "qnt_ingressantes"=dados_cursos$QT_ING, "tipo_de_inst"= case_when( dados_cursos$TP_REDE=="1"~"Publica",
    dados_cursos$TP_REDE=="2"\~"Privada"), "nmr_concluintes"=dados_cursos\$QT_CONC )

#Vagas e ingressantes por regiao vagas_regiao\<- dadosB %\>% group_by(regiao) %\>% summarise( vagas_total= sum(qnt_vagas), ingressantes= sum(qnt_ingressantes), `%_de_preenchimento`= round((ingressantes/vagas_total)\*100,2), .groups = 'drop')

ord_vagas_regiao\<- vagas_regiao%\>% arrange(desc(`%_de_preenchimento`)) print(ord_vagas_regiao)

#Concluintes por região e tipo de instituição concluintes_regiao\<- dadosB%\>% group_by(regiao)%\>% summarise( cln_regiao=sum(nmr_concluintes), .groups='drop')

concluinte\<- dadosB%\>% group_by(regiao,tipo_de_inst) %\>% summarise( qnt_concluintes= sum(nmr_concluintes), .groups= 'drop') print(concluinte)

concluinteB\<- concluinte%\>% left_join(concluintes_regiao, by ="regiao")%\>% mutate(pct_concluintes = round((qnt_concluintes / cln_regiao) \* 100, 2)) %\>% pivot_wider( names_from =tipo_de_inst, values_from = c(qnt_concluintes, pct_concluintes))%\>% arrange(desc(cln_regiao))%\>% select(-cln_regiao) print(concluinteB)
